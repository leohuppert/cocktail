{% extends 'base.html.twig' %}

{% block body %}
    <div id="app">
        <h1>Liste des recettes</h1>

        <div class="form-group">
            <input type="text" class="form-control" placeholder="Recherche recettes" v-model="search">
        </div>

        <div class="row">

            {#{% for recipe in recipes %}
                <div class="col-lg-4">
                    <a href="{{ path('recipe_show', { 'id': recipe.id }) }}">{{ recipe.name }}</a>
                </div>
            {% endfor %}#}

            <div class="col-lg-4" v-for="recipe in filteredList">
                ${ recipe.title }

                {#TODO : Utiliser FOSJSroutingBundle pour générer un lien pour chaque recette.#}
            </div>

        </div>
    </div>

    {% endblock %}

    {% block javascripts %}

    {{ parent() }}

    <script src="https://unpkg.com/vue@2.4.4/dist/vue.js"></script>

    <script>

        class Recipe {
            constructor(id, title) {
                this.id = id;
                this.title = title;
            }
        }

        let recipes = [];

        {% for recipe in recipes %}

        recipes.push(new Recipe({{ recipe.id }}, '{{ recipe.name }}'));

        {% endfor %}

        const app = new Vue({
            delimiters: ['${', '}'],
            el: '#app',
            data: {
                search: '',
                recipeList: recipes,
            },
            computed: {
                filteredList() {
                    return this.recipeList.filter(recipe => recipe.title.toLowerCase().includes(this.search.toLowerCase()));
                }
            }
        })

    </script>

{% endblock %}